#ifndef GL_PARAMETERS_H
#define GL_PARAMETERS_H

/**
  * @file parameters.hpp
  * @date may 2018
  * @author geewy
  * @brief Definition of the hardcoded constants for the scheme
  *
  */

#ifndef PLAN_MODE
#define PLAN_MODE FFTW_MEASURE
#endif

#define INPUT_BIT 6
#define P1 1439
#define P2 1447
#define P1inv_modP2 1266
#define P2inv_modP1 180
#define N 600	/*! < dimension of LWE samples as input to the accumulators */
#define FFT_DIM1 3072//4096
#define FFT_DIM2 4194304
#define T 64
#define U 1125899906842623	/*! < Q = 2^56 */
#define U_inv 70931694131085311	/*! < Q = 2^56 */
#define Q 72057594037927936	/*! < 2^56 */
#define B_Q 256
#define K_Q 7	/*! < floor(log(Q, B_Q)) */
#define SPLIT_Q 268435456	/*! < 2^56 = ceil(sqrt(Q)) */
#define Qp 72057594037927936	/*! < 2^56 */
#define B_Qp 256	/*! < decomposition basis of the gadget modulo Q */
#define K_Qp 7	/*! < floor(log(Qp, B_Qp)) */
#define SPLIT_Qp 268435456	/*! < 2^56 = ceil(sqrt(Qp)) */
#define B_Qp_2 64	/*! < decomposition basis of the gadget modulo Qp */
#define K_Qp_2 10	/*! < floor(log(Qp, B_Qp)) */
#define Qcrt 274811850625 /*! < ~2^38 */
#define QpoverT_inv -T /*! < -2 = u^-1 = inverse of round(Qp/T) mod Qp, if t==2, Qp==1021 => u^-1=-2 */
#define SPLIT_Qcrt 524225 /*! < 2^38 = ceil(sqrt(Qcrt)) */
#define B_PQ 128
#define K_PQ 3
#define DENSITY_KEY (1.0/3.0)
#define DENSITY_KEY_SMALL (1.0/3.0)
#define DENSITY_KEY_ACC (1.0/3.0)
#define VARIANCE_INPUT 4.0
#define VARIANCE_ACC 4.0
#define VARIANCE_FUNEXPEXTRACT 4.0
#define VARIANCE_KSWLWE 73786976294838206e3
#define ALIGNMENT 16

const int64_t inv_mod_P1[P1] = { 0,
  1, -719, 480, 360, 288, 240, -411, 180, 160, 144, -654, 120, -332, 514, 96, 90, 254, 80, 303, 72, -137, -327, 438, 60, -518, -166, 533, 257, 397, 48, -557, 45, -218, 127, -370, 40, -350, -568, 369, 36, 351, 651, 502, 556, 32, 219, -398, 30, 558, -259, -395, -83, -543, -453, 157, -591, 101, -521, -439, 24, 519, 441, 434, -697, -642, -109, 494, -656, 146, -185, -304, 20, 138, -175, 307, -284, -299, -535, -255, 18, -302, -544, -52, -394, -237, 251, 612, 278, -97, 16, -253, -610, 294, -199, -515, 15, -89, 279, 407, 590,
  57, 522, -475, 678, -603, 448, -390, 493, -66, -641, 363, 424, 624, -669, -488, 459, 123, 500, 653, 12, 333, -460, 117, -499, 472, 217, 34, 371, 647, -321, -714, 665, 660, 247, -469, -328, -21, 73, 176, 627, 347, -152, -161, 10, 655, 69, 186, 632, 367, -566, -162, -142, 348, 570, -687, 452, 55, 592, -181, 9, -143, -151, -565, -272, 532, -26, -517, -197, -579, 601, -446, -594, 183, 306, -74, 139, -626, 671, 410, 8, -159, 593, 173, -305, -70, 147, -631, 620, -335, 462, 663, -712, -507, 675, -214, -580, -168, -516, -94, 295,
  -315, -691, -560, 261, 358, 482, -431, 339, 420, 418, 341, 224, -581, -195, 676, -473, 126, -33, 46, 399, 573, -538, -342, 212, 582, 312, 355, 385, -465, -244, 380, -490, -667, -658, 496, 250, -85, -393, -289, 6, 412, -553, 379, -230, -464, -661, 134, 470, -497, 236, 86, -611, -91, 17, -79, -534, 28, -396, -50, 559, 204, -357, -383, -387, 467, 330, -512, -596, -444, 485, 531, -164, -564, 709, 607, -683, -613, 88, 98, -406, -635, -546, -300, -76, 308, 639, -361, 5, -239, -392, 450, -685, 609, 93, 200, 316, -344, -536, -77, -283,
  -545, -81, 19, -71, -184, 174, 75, 285, -638, 376, -583, 226, -354, -692, -201, 296, 345, 629, -618, -715, -130, 648, 695, 644, -704, 437, -22, -136, -468, 266, 513, -13, 121, 461, -189, 621, -427, 430, 208, -419, 211, -223, -537, -297, 317, -628, 141, 153, -569, -37, 41, -650, -693, -313, 227, -384, -262, 205, -481, 4, -287, 640, 111, -423, -548, -633, 149, 567, 39, -35, 128, -646, 706, 404, 637, 310, 584, 552, 243, 231, 491, -388, -263, -356, 228, 466, -264, -382, 492, -107, 449, -290, -238, -84, -51, -258, 29, -47, 220, -572,
  689, 562, -707, 374, -636, -280, 99, -589, -672, 179, -7, 241, 554, 504, -586, -550, -421, 210, -340, 209, -417, -549, -364, 112, -623, 429, -337, 622, 426, 338, -207, 483, -442, 63, 698, 703, 326, 23, -59, -520, 62, -433, 484, -269, -595, -171, 602, 106, 391, 291, 686, 156, -54, -542, 525, -527, 529, 487, 116, -122, 334, 190, -662, -245, -229, 386, 265, -329, -135, 248, 498, 125, -216, 677, -103, 523, -540, 575, 718, 3, -359, 206, 432, 443, 270, -530, 458, -115, -668, -232, 381, 389, 108, 67, 657, 235, -249, 471, -124, 118,
  -652, 43, -555, 414, 587, 674, -193, -711, -605, 680, -597, -267, 331, 14, -95, -198, -167, -25, 61, -440, -58, 102, 476, 541, 455, 528, -456, 526, 457, -486, 271, 165, 27, -256, -78, -298, -343, -222, 574, -477, 524, -454, -53, -82, -301, -282, -634, -365, -422, -416, -585, 378, -242, 413, -503, 44, -31, 49, 260, -203, -690, 402, 708, -273, -163, -150, 368, -38, -349, 154, 688, -400, 221, 539, 478, -717, -616, 600, -169, -196, -213, 225, -311, 377, -551, -415, 505, -673, -408, 100, -56, 158, 182, -172, -445, -268, -511, 681, 615, 578,
  170, 447, -105, 679, -509, -710, 275, 684, 293, -92, -252, 87, -277, -682, 599, -577, -716, -319, 630, 188, 336, 428, -425, 113, 670, -177, 140, -346, 318, 619, -187, 148, -366, -547, -281, -405, 375, -309, 286, 362, -110, -65, -696, 324, 705, -372, 129, 322, -694, -352, 42, -501, 119, -11, 145, -68, 495, -234, -666, 133, -246, -463, 191, 713, 132, -659, -233, -489, -114, 625, 178, -409, -588, 506, 194, 215, 474, 104, 604, 510, 598, -614, -276, 608, -292, 451, -155, 571, 401, -561, -202, -314, -353, -649, 323, -643, -64, 435, -702, 701,
  700, -699, 436, -325, 645, 373, -403, 563, 274, -606, -508, -192, 664, -131, -320, -617, -576, 479, -2, 2, -479, 576, 617, 320, 131, -664, 192, 508, 606, -274, -563, 403, -373, -645, 325, -436, 699, -700, -701, 702, -435, 64, 643, -323, 649, 353, 314, 202, 561, -401, -571, 155, -451, 292, -608, 276, 614, -598, -510, -604, -104, -474, -215, -194, -506, 588, 409, -178, -625, 114, 489, 233, 659, -132, -713, -191, 463, 246, -133, 666, 234, -495, 68, -145, 11, -119, 501, -42, 352, 694, -322, -129, 372, -705, -324, 696, 65, 110, -362, -286,
  309, -375, 405, 281, 547, 366, -148, 187, -619, -318, 346, -140, 177, -670, -113, 425, -428, -336, -188, -630, 319, 716, 577, -599, 682, 277, -87, 252, 92, -293, -684, -275, 710, 509, -679, 105, -447, -170, -578, -615, -681, 511, 268, 445, 172, -182, -158, 56, -100, 408, 673, -505, 415, 551, -377, 311, -225, 213, 196, 169, -600, 616, 717, -478, -539, -221, 400, -688, -154, 349, 38, -368, 150, 163, 273, -708, -402, 690, 203, -260, -49, 31, -44, 503, -413, 242, -378, 585, 416, 422, 365, 634, 282, 301, 82, 53, 454, -524, 477, -574,
  222, 343, 298, 78, 256, -27, -165, -271, 486, -457, -526, 456, -528, -455, -541, -476, -102, 58, 440, -61, 25, 167, 198, 95, -14, -331, 267, 597, -680, 605, 711, 193, -674, -587, -414, 555, -43, 652, -118, 124, -471, 249, -235, -657, -67, -108, -389, -381, 232, 668, 115, -458, 530, -270, -443, -432, -206, 359, -3, -718, -575, 540, -523, 103, -677, 216, -125, -498, -248, 135, 329, -265, -386, 229, 245, 662, -190, -334, 122, -116, -487, -529, 527, -525, 542, 54, -156, -686, -291, -391, -106, -602, 171, 595, 269, -484, 433, -62, 520, 59,
  -23, -326, -703, -698, -63, 442, -483, 207, -338, -426, -622, 337, -429, 623, -112, 364, 549, 417, -209, 340, -210, 421, 550, 586, -504, -554, -241, 7, -179, 672, 589, -99, 280, 636, -374, 707, -562, -689, 572, -220, 47, -29, 258, 51, 84, 238, 290, -449, 107, -492, 382, 264, -466, -228, 356, 263, 388, -491, -231, -243, -552, -584, -310, -637, -404, -706, 646, -128, 35, -39, -567, -149, 633, 548, 423, -111, -640, 287, -4, 481, -205, 262, 384, -227, 313, 693, 650, -41, 37, 569, -153, -141, 628, -317, 297, 537, 223, -211, 419, -208,
  -430, 427, -621, 189, -461, -121, 13, -513, -266, 468, 136, 22, -437, 704, -644, -695, -648, 130, 715, 618, -629, -345, -296, 201, 692, 354, -226, 583, -376, 638, -285, -75, -174, 184, 71, -19, 81, 545, 283, 77, 536, 344, -316, -200, -93, -609, 685, -450, 392, 239, -5, 361, -639, -308, 76, 300, 546, 635, 406, -98, -88, 613, 683, -607, -709, 564, 164, -531, -485, 444, 596, 512, -330, -467, 387, 383, 357, -204, -559, 50, 396, -28, 534, 79, -17, 91, 611, -86, -236, 497, -470, -134, 661, 464, 230, -379, 553, -412, -6, 289,
  393, 85, -250, -496, 658, 667, 490, -380, 244, 465, -385, -355, -312, -582, -212, 342, 538, -573, -399, -46, 33, -126, 473, -676, 195, 581, -224, -341, -418, -420, -339, 431, -482, -358, -261, 560, 691, 315, -295, 94, 516, 168, 580, 214, -675, 507, 712, -663, -462, 335, -620, 631, -147, 70, 305, -173, -593, 159, -8, -410, -671, 626, -139, 74, -306, -183, 594, 446, -601, 579, 197, 517, 26, -532, 272, 565, 151, 143, -9, 181, -592, -55, -452, 687, -570, -348, 142, 162, 566, -367, -632, -186, -69, -655, -10, 161, 152, -347, -627, -176,
  -73, 21, 328, 469, -247, -660, -665, 714, 321, -647, -371, -34, -217, -472, 499, -117, 460, -333, -12, -653, -500, -123, -459, 488, 669, -624, -424, -363, 641, 66, -493, 390, -448, 603, -678, 475, -522, -57, -590, -407, -279, 89, -15, 515, 199, -294, 610, 253, -16, 97, -278, -612, -251, 237, 394, 52, 544, 302, -18, 255, 535, 299, 284, -307, 175, -138, -20, 304, 185, -146, 656, -494, 109, 642, 697, -434, -441, -519, -24, 439, 521, -101, 591, -157, 453, 543, 83, 395, 259, -558, -30, 398, -219, -32, -556, -502, -651, -351, -36, -369,
  568, 350, -40, 370, -127, 218, -45, 557, -48, -397, -257, -533, 166, 518, -60, -438, 327, 137, -72, -303, -80, -254, -90, -96, -514, 332, -120, 654, -144, -160, -180, 411, -240, -288, -360, -480, 719, -1
};
const int64_t inv_mod_P2[P2] = { 0,
  1, -723, -482, 362, 579, -241, -620, 181, -643, -434, -263, 603, 334, -310, 193, -633, 681, 402, 457, -217, -689, 592, -692, -422, -463, 167, 268, -155, 499, -627, -140, 407, -570, -383, -124, 201, 352, -495, -371, 615, 600, 379, -673, 296, -418, -346, -431, -211, -502, 492, 227, -640, -273, 134, -342, 646, -330, -474, 466, 410, 427, -70, -712, -520, -512, -285, 108, 532, -713, -62, 428, -623, -555, 176, 328, 476, -451, 538, -348, -416, -393, 300, -523, -534, 715, 387, -316, 148, -504, -209, -159, -173, -529, 508, -198, 618, -179, -251, -190, 246,
  -702, -610, 576, -320, 441, 587, 284, 67, -531, -171, -365, 323, 461, -165, 151, -237, -606, 233, 304, 205, -287, -510, 200, -35, -382, -356, 376, -260, 258, -256, -243, 581, 272, 54, 343, 266, 169, 367, 406, -31, -626, 214, 425, 412, -479, 446, 315, 88, 505, 164, 115, 238, 558, 498, -28, 269, 553, -174, -91, -208, -719, 527, -506, 150, -114, 462, 26, -267, 137, -366, -110, -530, -92, -158, 554, 74, -327, -252, -97, 619, 8, 644, -340, 637, -219, 459, 325, 254, 245, -99, -250, 309, 15, 634, -653, 598, 617, -95, 509, 123,
  36, -351, 278, -305, 120, 288, -720, -160, -90, -503, -48, -430, 625, 142, -424, -690, -20, 458, -185, 638, 275, 541, 292, -562, -373, -493, 51, 641, 436, -648, 332, 605, 118, -303, -665, -607, -116, 152, -557, -621, -6, 580, -131, -255, 189, 100, 703, 706, 308, -191, -98, -178, -326, 188, -244, -130, 259, 129, 257, -128, 377, 602, -11, -433, -344, 136, -168, 27, 156, -552, -582, 133, -53, -639, 221, -540, 350, 203, 306, 708, -448, -313, -588, 107, -66, -511, -121, 206, 721, 484, -542, 223, 563, -566, 672, 44, 419, -471, 392, 82,
  524, -666, -234, 119, -204, 279, -707, 249, 192, -14, 335, -589, -282, -447, 147, -87, 388, 678, 440, -104, 577, 364, 112, -460, 187, -253, -177, 75, -475, -57, 647, 231, -604, 13, 311, 590, -687, -655, 636, -183, 645, -55, 135, -265, -432, -46, -417, -79, 539, 277, -202, 37, 496, 560, 375, -126, -381, 675, -395, -414, 481, 4, -578, 322, -111, -170, 138, -405, 549, 614, -39, -494, -225, -561, 355, 127, 261, -601, 42, 674, -357, -125, -34, -569, -669, -716, 86, 317, -677, 397, 470, 299, -81, -415, -359, 676, 390, -469, 573, -662,
  -682, 18, -456, 548, -368, 139, 32, 571, -467, 60, -426, 144, 480, -360, -394, -80, -347, -45, 297, 472, -464, -24, -691, -215, 143, -411, 61, 71, 624, -212, -47, -345, -264, -10, -642, 229, 649, 631, -679, 319, 105, -586, -699, -453, 478, 146, -314, -281, 709, 537, -77, 477, -444, -698, 547, -403, 19, 218, 186, -324, 113, 166, -25, -421, 473, 59, -409, 572, -398, 391, -298, 420, 465, -58, -329, 76, 452, 445, -145, 413, 361, -3, -722, 290, 543, 658, 517, 596, -651, -629, 501, 50, -226, -372, -38, 353, -559, 154, 29, 628,
  491, -49, -210, -89, 149, -163, 528, 94, 199, -122, -286, -65, -519, -594, 694, -659, 487, -595, -513, -64, -711, -535, -83, 301, 667, 718, 162, 507, -93, -172, -109, 68, 714, -84, -522, -710, 450, 78, 349, -276, 222, -291, 485, -657, -685, 697, 455, 404, 369, -613, -583, -270, 157, 175, -73, -622, -239, 153, -497, 354, -374, -224, 293, 567, 671, -294, 564, -670, -384, -33, 408, 468, 399, 663, 609, 103, 321, -363, 5, 242, 132, -271, -551, -612, -700, -442, 106, -283, -312, 336, 688, 22, 693, -514, -518, 488, 652, 196, -616, 41,
  -378, 262, 12, -333, 232, -117, -236, -664, 575, -102, -701, -584, -550, 370, 40, -599, 197, 96, 180, -7, -240, -556, -72, 429, 213, -141, -30, 500, -490, -650, 438, 680, -16, 194, 654, 339, 184, 220, -274, -52, 228, -435, -9, 182, 341, 56, 331, -230, 437, -630, -489, 597, -195, 635, -338, -686, -544, 486, -516, 695, -683, -400, 574, -608, -235, -302, 525, -717, -385, -568, 565, 295, -43, 380, 358, 396, -389, 318, -439, 632, 17, -401, -661, 696, -545, -656, -337, 591, -21, -216, -423, -23, 593, 515, 660, 684, 546, -454, -443, -585,
  -611, -101, 247, -705, -704, 248, -307, 280, 449, -536, -521, -63, -69, 533, 85, -386, -668, 526, -161, -207, 289, -483, -2, 2, 483, -289, 207, 161, -526, 668, 386, -85, -533, 69, 63, 521, 536, -449, -280, 307, -248, 704, 705, -247, 101, 611, 585, 443, 454, -546, -684, -660, -515, -593, 23, 423, 216, 21, -591, 337, 656, 545, -696, 661, 401, -17, -632, 439, -318, 389, -396, -358, -380, 43, -295, -565, 568, 385, 717, -525, 302, 235, 608, -574, 400, 683, -695, 516, -486, 544, 686, 338, -635, 195, -597, 489, 630, -437, 230, -331,
  -56, -341, -182, 9, 435, -228, 52, 274, -220, -184, -339, -654, -194, 16, -680, -438, 650, 490, -500, 30, 141, -213, -429, 72, 556, 240, 7, -180, -96, -197, 599, -40, -370, 550, 584, 701, 102, -575, 664, 236, 117, -232, 333, -12, -262, 378, -41, 616, -196, -652, -488, 518, 514, -693, -22, -688, -336, 312, 283, -106, 442, 700, 612, 551, 271, -132, -242, -5, 363, -321, -103, -609, -663, -399, -468, -408, 33, 384, 670, -564, 294, -671, -567, -293, 224, 374, -354, 497, -153, 239, 622, 73, -175, -157, 270, 583, 613, -369, -404, -455,
  -697, 685, 657, -485, 291, -222, 276, -349, -78, -450, 710, 522, 84, -714, -68, 109, 172, 93, -507, -162, -718, -667, -301, 83, 535, 711, 64, 513, 595, -487, 659, -694, 594, 519, 65, 286, 122, -199, -94, -528, 163, -149, 89, 210, 49, -491, -628, -29, -154, 559, -353, 38, 372, 226, -50, -501, 629, 651, -596, -517, -658, -543, -290, 722, 3, -361, -413, 145, -445, -452, -76, 329, 58, -465, -420, 298, -391, 398, -572, 409, -59, -473, 421, 25, -166, -113, 324, -186, -218, -19, 403, -547, 698, 444, -477, 77, -537, -709, 281, 314,
  -146, -478, 453, 699, 586, -105, -319, 679, -631, -649, -229, 642, 10, 264, 345, 47, 212, -624, -71, -61, 411, -143, 215, 691, 24, 464, -472, -297, 45, 347, 80, 394, 360, -480, -144, 426, -60, 467, -571, -32, -139, 368, -548, 456, -18, 682, 662, -573, 469, -390, -676, 359, 415, 81, -299, -470, -397, 677, -317, -86, 716, 669, 569, 34, 125, 357, -674, -42, 601, -261, -127, -355, 561, 225, 494, 39, -614, -549, 405, -138, 170, 111, -322, 578, -4, -481, 414, 395, -675, 381, 126, -375, -560, -496, -37, 202, -277, -539, 79, 417,
  46, 432, 265, -135, 55, -645, 183, -636, 655, 687, -590, -311, -13, 604, -231, -647, 57, 475, -75, 177, 253, -187, 460, -112, -364, -577, 104, -440, -678, -388, 87, -147, 447, 282, 589, -335, 14, -192, -249, 707, -279, 204, -119, 234, 666, -524, -82, -392, 471, -419, -44, -672, 566, -563, -223, 542, -484, -721, -206, 121, 511, 66, -107, 588, 313, 448, -708, -306, -203, -350, 540, -221, 639, 53, -133, 582, 552, -156, -27, 168, -136, 344, 433, 11, -602, -377, 128, -257, -129, -259, 130, 244, -188, 326, 178, 98, 191, -308, -706, -703,
  -100, -189, 255, 131, -580, 6, 621, 557, -152, 116, 607, 665, 303, -118, -605, -332, 648, -436, -641, -51, 493, 373, 562, -292, -541, -275, -638, 185, -458, 20, 690, 424, -142, -625, 430, 48, 503, 90, 160, 720, -288, -120, 305, -278, 351, -36, -123, -509, 95, -617, -598, 653, -634, -15, -309, 250, 99, -245, -254, -325, -459, 219, -637, 340, -644, -8, -619, 97, 252, 327, -74, -554, 158, 92, 530, 110, 366, -137, 267, -26, -462, 114, -150, 506, -527, 719, 208, 91, 174, -553, -269, 28, -498, -558, -238, -115, -164, -505, -88, -315,
  -446, 479, -412, -425, -214, 626, 31, -406, -367, -169, -266, -343, -54, -272, -581, 243, 256, -258, 260, -376, 356, 382, 35, -200, 510, 287, -205, -304, -233, 606, 237, -151, 165, -461, -323, 365, 171, 531, -67, -284, -587, -441, 320, -576, 610, 702, -246, 190, 251, 179, -618, 198, -508, 529, 173, 159, 209, 504, -148, 316, -387, -715, 534, 523, -300, 393, 416, 348, -538, 451, -476, -328, -176, 555, 623, -428, 62, 713, -532, -108, 285, 512, 520, 712, 70, -427, -410, -466, 474, 330, -646, 342, -134, 273, 640, -227, -492, 502, 211, 431,
  346, 418, -296, 673, -379, -600, -615, 371, 495, -352, -201, 124, 383, 570, -407, 140, 627, -499, 155, -268, -167, 463, 422, 692, -592, 689, 217, -457, -402, -681, 633, -193, 310, -334, -603, 263, 434, 643, -181, 620, 241, -579, -362, 482, 723, -1
};

#endif
